I"î
<p>æœ¬æ–‡ç®€è¦ä»‹ç»å·¦ç§»å¯¼è‡´çš„æº¢å‡ºé—®é¢˜ã€‚</p>

<p>å®é™…é¡¹ç›®ä¸­éœ€è¦è®¡ç®—SDå¡ä¸­æŸä¸ªç›®å½•çš„å¤§å°ï¼Œå¹¶åˆ¤æ–­è¯¥ç›®å½•æ‰€å ç©ºé—´æ˜¯å¦è¶…è¿‡SDå¡æ€»å®¹é‡çš„ä¸€åŠã€‚<br />
æµ‹è¯•è¿‡ç¨‹ä¸­ç»å¸¸å‘ç°è¯¯æŠ¥ï¼Œè¯¥ç›®å½•æ‰€å ç©ºé—´è¿œå°äºSDå¡å®¹é‡ä¸€åŠçš„æ—¶å€™ï¼Œå°±ä¸ŠæŠ¥å ç”¨ç©ºé—´è¿‡åŠçš„äº‹ä»¶ã€‚<br />
æ’æŸ¥å‘ç°åŸæ¥æ˜¯è®¡ç®—çš„æ—¶å€™ç§»ä½å¯¼è‡´äº†æº¢å‡ºã€‚é—®é¢˜ä»£ç å¦‚ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>unsigned int total_space_in_mb;
unsigned long long used_space_in_byte;

/* total_space_in_mb å·¦ç§»20ä½ä»MBè½¬æ¢ä¸ºbyte, å·¦ç§»19ä½ç›¸å½“äºæ€»å®¹é‡çš„ä¸€åŠ */
used_space_in_byte &gt; (unsigned long long)(total_space_in_mb &lt;&lt; (20 - 1));
</code></pre></div></div>

<p>æˆ‘ä»¬ä»¥ä¸‹é¢çš„ä¾‹å­æ¥åˆ†æä¸‹åŸå› :</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include&lt;stdio.h&gt;
int main()
{
    unsigned int total_space_in_mb = 30208;
    unsigned long long result;

    result = (unsigned long long)(total_space_in_mb &lt;&lt; 19);
    printf("wrong result:%llu\n", result); /* wrong result:2952790016 */
    
    result = ((unsigned long long)total_space_in_mb &lt;&lt; 19);
    printf("right result:%llu\n", result); /* right result:15837691904 */
	return 0;
}

</code></pre></div></div>

<p>å°†åè¿›åˆ¶è¡¨ç¤ºè½¬æ¢ä¸ºå¯¹åº”çš„äºŒè¿›åˆ¶ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â€­30208å¯¹åº”çš„äºŒè¿›åˆ¶ï¼š                          0111011000000000
â€­2952790016å¯¹åº”çš„äºŒè¿›åˆ¶ï¼š     10110000000000000000000000000000ï¼ˆ30208å·¦ç§»19ä½ï¼Œæº¢å‡º2ä½ï¼‰
â€­15837691904å¯¹åº”çš„äºŒè¿›åˆ¶ï¼š001110110000000000000000000000000000ï¼ˆ30208å·¦ç§»19ä½ï¼Œæ— æº¢å‡ºï¼‰â€¬â€¬â€¬
</code></pre></div></div>

<p>é”™è¯¯çš„ä»£ç ä¸­è™½ç„¶è¿›è¡Œäº†å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œä½†æ˜¯è½¬æ¢å‘ç”Ÿåœ¨ç§»ä½åï¼Œæ‰€ä»¥æ— æ³•é¿å…æº¢å‡ºã€‚<br />
æ­£ç¡®çš„ä»£ç å…ˆè¿›è¡Œäº†ç±»å‹æå‡ï¼Œç„¶åå†ç§»ä½ï¼Œå¯ä»¥é¿å…æº¢å‡ºã€‚<br />
è¿™ç‚¹ä»æ±‡ç¼–ä»£ç ä¸­å¯ä»¥çœ‹å‡ºã€‚<br />
æ‰§è¡Œgcc -S test.cå¯ä»¥ç”Ÿäº§åä¸ºtest.sçš„æ±‡ç¼–ä»£ç æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	.file	"test.c"
	.section	.rodata
.LC0:
	.string	"wrong result:%llu\n"
.LC1:
	.string	"right result:%llu\n"
	.text
	.globl	main
	.type	main, @function
main:
.LFB0:
	.cfi_startproc
	pushq	%rbp
	.cfi_def_cfa_offset 16
	.cfi_offset 6, -16
	movq	%rsp, %rbp
	.cfi_def_cfa_register 6
	subq	$16, %rsp
	movl	$30208, -12(%rbp)
	movl	-12(%rbp), %eax
	sall	$19, %eax
	movl	%eax, %eax
	movq	%rax, -8(%rbp)
	movq	-8(%rbp), %rax
	movq	%rax, %rsi
	movl	$.LC0, %edi
	movl	$0, %eax
	call	printf
	movl	-12(%rbp), %eax
	salq	$19, %rax
	movq	%rax, -8(%rbp)
	movq	-8(%rbp), %rax
	movq	%rax, %rsi
	movl	$.LC1, %edi
	movl	$0, %eax
	call	printf
	movl	$0, %eax
	leave
	.cfi_def_cfa 7, 8
	ret
	.cfi_endproc
.LFE0:
	.size	main, .-main
	.ident	"GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609"
	.section	.note.GNU-stack,"",@progbits

</code></pre></div></div>

<p>å¯ä»¥çœ‹å‡ºï¼Œ é”™è¯¯ä»£ç è°ƒç”¨äº†32ä½ç®—æ•°å·¦ç§»æŒ‡ä»¤sall, æ­£ç¡®ä»£ç è°ƒç”¨äº†64ä½ç®—æœ¯å·¦ç§»æŒ‡ä»¤salqã€‚<br />
å…¶ä¸­eaxæ˜¯å¯„å­˜å™¨raxçš„ä½32ä½ã€‚</p>

<p><strong>å‚è€ƒæ–‡æ¡£ï¼š</strong><br />
<a href="https://software.intel.com/en-us/articles/introduction-to-x64-assembly">https://software.intel.com/en-us/articles/introduction-to-x64-assembly</a><br />
<a href="https://my.oschina.net/guonaihong/blog/511576">https://my.oschina.net/guonaihong/blog/511576</a></p>
:ET