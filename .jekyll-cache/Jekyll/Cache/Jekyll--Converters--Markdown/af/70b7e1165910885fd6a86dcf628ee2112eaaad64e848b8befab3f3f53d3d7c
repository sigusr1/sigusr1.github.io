I"c‘<ul id="markdown-toc">
  <li><a href="#ä¸€é¢„å¤‡çŸ¥è¯†" id="markdown-toc-ä¸€é¢„å¤‡çŸ¥è¯†">ä¸€ã€é¢„å¤‡çŸ¥è¯†</a></li>
  <li><a href="#äºŒå®éªŒç¯å¢ƒ" id="markdown-toc-äºŒå®éªŒç¯å¢ƒ">äºŒã€å®éªŒç¯å¢ƒ</a></li>
  <li><a href="#ä¸‰æ ˆ" id="markdown-toc-ä¸‰æ ˆ">ä¸‰ã€æ ˆ</a></li>
  <li><a href="#å››å †" id="markdown-toc-å››å †">å››ã€å †</a></li>
  <li><a href="#äº”å¯æ‰§è¡Œç¨‹åºçš„ä½ç½®" id="markdown-toc-äº”å¯æ‰§è¡Œç¨‹åºçš„ä½ç½®">äº”ã€å¯æ‰§è¡Œç¨‹åºçš„ä½ç½®</a></li>
  <li><a href="#å…­å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡" id="markdown-toc-å…­å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡">å…­ã€å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡</a>    <ul>
      <li><a href="#æ•°ç»„å˜é‡argvå’Œenvæ˜¯ç›¸é‚»çš„å—" id="markdown-toc-æ•°ç»„å˜é‡argvå’Œenvæ˜¯ç›¸é‚»çš„å—">æ•°ç»„å˜é‡argvå’Œenvæ˜¯ç›¸é‚»çš„å—ï¼Ÿ</a></li>
      <li><a href="#ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ç´§æŒ¨ç€æ•°ç»„å˜é‡envå—" id="markdown-toc-ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ç´§æŒ¨ç€æ•°ç»„å˜é‡envå—">ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ç´§æŒ¨ç€æ•°ç»„å˜é‡envå—ï¼Ÿ</a></li>
    </ul>
  </li>
  <li><a href="#ä¸ƒæ ˆçœŸçš„æ˜¯å‘ä¸‹ç”Ÿé•¿å—" id="markdown-toc-ä¸ƒæ ˆçœŸçš„æ˜¯å‘ä¸‹ç”Ÿé•¿å—">ä¸ƒã€æ ˆçœŸçš„æ˜¯å‘ä¸‹ç”Ÿé•¿å—ï¼Ÿ</a></li>
  <li><a href="#å…«proc" id="markdown-toc-å…«proc">å…«ã€/proc</a></li>
  <li><a href="#ä¹ä¸‹èŠ‚é¢„å‘Š" id="markdown-toc-ä¹ä¸‹èŠ‚é¢„å‘Š">ä¹ã€ä¸‹èŠ‚é¢„å‘Š</a></li>
  <li><a href="#åç»§ç»­é˜…è¯»" id="markdown-toc-åç»§ç»­é˜…è¯»">åã€ç»§ç»­é˜…è¯»</a></li>
  <li><a href="#åä¸€åŸæ–‡é“¾æ¥" id="markdown-toc-åä¸€åŸæ–‡é“¾æ¥">åä¸€ã€åŸæ–‡é“¾æ¥</a></li>
</ul>
<p>è¿™æ˜¯è™šæ‹Ÿå†…å­˜ç³»åˆ—æ–‡ç« çš„ç¬¬ä¸‰ç¯‡ã€‚<br />
å‰é¢æˆ‘ä»¬æåˆ°åœ¨è¿›ç¨‹çš„è™šæ‹Ÿå†…å­˜ä¸­å¯ä»¥æ‰¾åˆ°å“ªäº›ä¸œè¥¿ï¼Œä»¥åŠåœ¨å“ªé‡Œå»æ‰¾ã€‚<br />
æœ¬æ–‡æˆ‘ä»¬å°†é€šè¿‡æ‰“å°ç¨‹åºä¸­ä¸åŒå…ƒç´ å†…å­˜åœ°å€çš„æ–¹å¼ï¼Œä¸€æ­¥ä¸€æ­¥ç»†åŒ–ä¸‹é¢çš„è™šæ‹Ÿå†…å­˜å›¾ï¼š</p>

<p><img src="http://data.coderhuo.tech/blog/virtual_memory/virtual_memory.jpg" alt="è™šæ‹Ÿå†…å­˜ç¤ºæ„å›¾" /></p>

<h2 id="ä¸€é¢„å¤‡çŸ¥è¯†">ä¸€ã€é¢„å¤‡çŸ¥è¯†</h2>

<p>ä¸ºäº†æ–¹ä¾¿ç†è§£æœ¬æ–‡ï¼Œä½ éœ€è¦å…·å¤‡ä»¥ä¸‹çŸ¥è¯†ï¼š</p>

<ul>
  <li>Cè¯­è¨€åŸºç¡€</li>
  <li>ä¸€äº›æ±‡ç¼–çŸ¥è¯†ï¼ˆéå¿…éœ€ï¼‰</li>
  <li>äº†è§£Linuxçš„æ–‡ä»¶ç³»ç»Ÿå’Œshellå‘½ä»¤</li>
  <li>äº†è§£æ–‡ä»¶<code class="highlighter-rouge">/proc/[pid]/maps</code>ï¼ˆå¯å‚é˜…<code class="highlighter-rouge">man proc</code>æˆ–<a href="http://blog.coderhuo.tech/2017/10/12/Virtual_Memory_C_strings_proc/">ã€Šè™šæ‹Ÿå†…å­˜æ¢ç©¶ â€“ ç¬¬ä¸€ç¯‡:C strings &amp; /procã€‹</a>ä¸­çš„ç›¸å…³ä»‹ç»ï¼‰</li>
</ul>

<h2 id="äºŒå®éªŒç¯å¢ƒ">äºŒã€å®éªŒç¯å¢ƒ</h2>
<p>æ‰€æœ‰çš„è„šæœ¬å’Œç¨‹åºéƒ½åœ¨ä¸‹é¢çš„ç¯å¢ƒä¸­æµ‹è¯•è¿‡ï¼š</p>

<ul>
  <li>Ubuntu
    <ul>
      <li>Linux ubuntu 4.4.0-31-generic #50~14.04.1-Ubuntu SMP Wed Jul 13 01:07:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</li>
      <li><strong>ä¸‹é¢æåˆ°çš„éƒ½æ˜¯åŸºäºæœ¬ç³»ç»Ÿçš„ï¼Œå…¶ä»–ç³»ç»Ÿå¯èƒ½ä¼šæœ‰å·®å¼‚</strong></li>
    </ul>
  </li>
  <li>gcc
    <ul>
      <li>gcc (Ubuntu 4.8.4-2ubuntu1~14.04.3) 4.8.4</li>
    </ul>
  </li>
  <li>objdump
    <ul>
      <li>GNU objdump (GNU Binutils for Ubuntu) 2.24</li>
    </ul>
  </li>
  <li>udcli
    <ul>
      <li>udis86 1.7.2</li>
    </ul>
  </li>
  <li>bc
    <ul>
      <li>bc 1.06.95</li>
    </ul>
  </li>
</ul>

<h2 id="ä¸‰æ ˆ">ä¸‰ã€æ ˆ</h2>

<p>é¦–å…ˆæˆ‘ä»¬æƒ³ç¡®è®¤çš„æ˜¯æ ˆåœ¨è™šæ‹Ÿå†…å­˜ä¸­çš„ä½ç½®ã€‚<br />
æˆ‘ä»¬çŸ¥é“ï¼ŒCè¯­è¨€ä¸­çš„å±€éƒ¨å˜é‡ä½äºæ ˆä¸Šã€‚å¦‚æœæˆ‘ä»¬æ‰“å°ä¸€ä¸ªå±€éƒ¨å˜é‡çš„å†…å­˜åœ°å€ï¼Œå°±å¯ä»¥æ ¹æ®è¿™ä¸ªåœ°å€å¯»æ‰¾æ ˆåœ¨è™šæ‹Ÿå†…å­˜ä¸­çš„ä½ç½®ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„ç¨‹åºï¼ˆ<code class="highlighter-rouge">main-1.c</code>ï¼‰å¯»æ‰¾æ ˆçš„ä½ç½®ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

/**
 * main - print locations of various elements
 *
 * Return: EXIT_FAILURE if something failed. Otherwise EXIT_SUCCESS
 */
int main(void)
{
    int a;

    printf("Address of a: %p\n", (void *)&amp;a);
    return (EXIT_SUCCESS);
}
</code></pre></div></div>
<p>ç¼–è¯‘è¿è¡Œ:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julien@holberton:~/holberton/w/hackthevm2$ gcc -Wall -Wextra -pedantic -Werror main-0.c -o 0
julien@holberton:~/holberton/w/hackthevm2$ ./0
Address of a: 0x7ffd14b8bd9c
julien@holberton:~/holberton/w/hackthevm2$ 
</code></pre></div></div>
<p>è¿™æ˜¯æˆ‘ä»¬å’Œå…¶ä»–å…ƒç´ çš„åœ°å€ç›¸æ¯”çš„ç¬¬ä¸€ä¸ªå‚ç…§åœ°å€ã€‚</p>

<h2 id="å››å †">å››ã€å †</h2>

<p>æˆ‘ä»¬ä½¿ç”¨<code class="highlighter-rouge">malloc</code>ä¸ºå˜é‡åˆ†é…çš„å†…å­˜ä½äºå †ä¸Šã€‚<br />
å¯ä»¥åœ¨ç¨‹åºä¸­æ·»åŠ ä¸€ä¸ªä½¿ç”¨<code class="highlighter-rouge">malloc</code>çš„è¯­å¥ï¼Œå€Ÿæ­¤æŸ¥çœ‹<code class="highlighter-rouge">malloc</code>è¿”å›çš„åœ°å€ä½äºå“ªé‡Œã€‚å¦‚ä¸‹æ‰€ç¤º(<code class="highlighter-rouge">main-1.c</code>)ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

/**
 * main - print locations of various elements
 *
 * Return: EXIT_FAILURE if something failed. Otherwise EXIT_SUCCESS
 */
int main(void)
{
    int a;
    void *p;

    printf("Address of a: %p\n", (void *)&amp;a);
    p = malloc(98);
    if (p == NULL)
    {
        fprintf(stderr, "Can't malloc\n");
        return (EXIT_FAILURE);
    }
    printf("Allocated space in the heap: %p\n", p);
    return (EXIT_SUCCESS);
}
</code></pre></div></div>
<p>ç¼–è¯‘è¿è¡Œ:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julien@holberton:~/holberton/w/hackthevm2$ gcc -Wall -Wextra -pedantic -Werror main-1.c -o 1
julien@holberton:~/holberton/w/hackthevm2$ ./1 
Address of a: 0x7ffd4204c554
Allocated space in the heap: 0x901010
julien@holberton:~/holberton/w/hackthevm2$ 
</code></pre></div></div>

<p>è‡³æ­¤å¯ä»¥ç¡®å®šå †(<code class="highlighter-rouge">0x901010</code>)åœ¨æ ˆ(<code class="highlighter-rouge">0x7ffd4204c554</code>)çš„ä¸‹é¢ã€‚æ®æ­¤å¯ä»¥ç”»å‡ºå¦‚ä¸‹çš„å†…å­˜å›¾:</p>

<p><img src="http://data.coderhuo.tech/blog/virtual_memory/virtual_memory_stack_heap.png" alt="å†…å­˜å¸ƒå±€ç¤ºæ„å›¾" /></p>

<h2 id="äº”å¯æ‰§è¡Œç¨‹åºçš„ä½ç½®">äº”ã€å¯æ‰§è¡Œç¨‹åºçš„ä½ç½®</h2>
<p>å¯æ‰§è¡Œç¨‹åºä¹Ÿä¼šè¢«åŠ è½½åˆ°è™šæ‹Ÿå†…å­˜ä¸­ã€‚å¦‚æœæˆ‘ä»¬æ‰“å°<code class="highlighter-rouge">main</code>å‡½æ•°çš„åœ°å€ï¼Œå°±å¯ä»¥çŸ¥é“å¯æ‰§è¡Œç¨‹åºåœ¨è™šæ‹Ÿå†…å­˜ä¸­ç›¸å¯¹äºå †æ ˆçš„ä½ç½®ã€‚<br />
æˆ‘ä»¬çœ‹çœ‹å®ƒæ˜¯å¦çœŸçš„åœ¨å †çš„ä¸‹é¢(<code class="highlighter-rouge">main-2.c</code>)ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

/**
 * main - print locations of various elements
 *
 * Return: EXIT_FAILURE if something failed. Otherwise EXIT_SUCCESS
 */
int main(void)
{
    int a;
    void *p;

    printf("Address of a: %p\n", (void *)&amp;a);
    p = malloc(98);
    if (p == NULL)
    {
        fprintf(stderr, "Can't malloc\n");
        return (EXIT_FAILURE);
    }
    printf("Allocated space in the heap: %p\n", p);
    printf("Address of function main: %p\n", (void *)main);
    return (EXIT_SUCCESS);
}
</code></pre></div></div>
<p>ç¼–è¯‘å¹¶è¿è¡Œ:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julien@holberton:~/holberton/w/hackthevm2$ gcc -Wall -Wextra -Werror main-2.c -o 2
julien@holberton:~/holberton/w/hackthevm2$ ./2 
Address of a: 0x7ffdced37d74
Allocated space in the heap: 0x2199010
Address of function main: 0x40060d
julien@holberton:~/holberton/w/hackthevm2$ 
</code></pre></div></div>

<p>ä¸å‡ºæ‰€æ–™ï¼Œå¯æ‰§è¡Œç¨‹åº(<code class="highlighter-rouge">0x40060d</code>)æœç„¶ä½äºå †çš„ä¸‹é¢ï¼ˆ<code class="highlighter-rouge">0x2199010</code>)ã€‚ä½†æˆ‘ä»¬å¿…é¡»ç¡®è®¤è¿™æ˜¯æˆ‘ä»¬çš„ç¨‹åºæ‰€åœ¨åœ°å€ï¼Œè€Œä¸æ˜¯æŒ‡å‘å…¶ä»–åœ°å€çš„æŒ‡é’ˆçš„åœ°å€ã€‚æˆ‘ä»¬å€ŸåŠ©å·¥å…·<a href="https://en.wikipedia.org/wiki/Objdump">objdump</a>æ¥æŸ¥çœ‹å‡½æ•°<code class="highlighter-rouge">main</code>çš„å†…å­˜åœ°å€ï¼š</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julien@holberton:~/holberton/w/hackthevm2$ objdump -M intel -j .text -d 2 | grep '&lt;main&gt;:' -A 5
000000000040060d &lt;main&gt;:
  40060d:   55                      push   rbp
  40060e:   48 89 e5                mov    rbp,rsp
  400611:   48 83 ec 10             sub    rsp,0x10
  400615:   48 8d 45 f4             lea    rax,[rbp-0xc]
  400619:   48 89 c6                mov    rsi,rax
</code></pre></div></div>

<p><code class="highlighter-rouge">000000000040060d &lt;main&gt;</code> â€“&gt;è¯¥åœ°å€å’Œæˆ‘ä»¬æ‰“å°å‡ºæ¥çš„<code class="highlighter-rouge">0x40060d</code>ä¸€è‡´ã€‚å¦‚æœä½ è¿˜æŒæœ‰æ€€ç–‘ï¼Œå¯ä»¥æ‰“å°å‡ºè¯¥åœ°å€å¼€å§‹çš„å‡ ä¸ªå­—èŠ‚ï¼Œçœ‹çœ‹å’Œ<code class="highlighter-rouge">objdump</code>è¾“å‡ºçš„æ˜¯å¦ä¸€è‡´(<code class="highlighter-rouge">main-3.c</code>)ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

/**
 * main - print locations of various elements
 *
 * Return: EXIT_FAILURE if something failed. Otherwise EXIT_SUCCESS
 */
int main(void)
{
    int a;
    void *p;
    unsigned int i;

    printf("Address of a: %p\n", (void *)&amp;a);
    p = malloc(98);
    if (p == NULL)
    {
        fprintf(stderr, "Can't malloc\n");
        return (EXIT_FAILURE);
    }
    printf("Allocated space in the heap: %p\n", p);
    printf("Address of function main: %p\n", (void *)main);
    printf("First bytes of the main function:\n\t");
    for (i = 0; i &lt; 15; i++)
    {
        printf("%02x ", ((unsigned char *)main)[i]);
    }
    printf("\n");
    return (EXIT_SUCCESS);
}
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julien@holberton:~/holberton/w/hackthevm2$ gcc -Wall -Wextra -Werror main-3.c -o 3
julien@holberton:~/holberton/w/hackthevm2$ objdump -M intel -j .text -d 3 | grep '&lt;main&gt;:' -A 5
000000000040064d &lt;main&gt;:
  40064d:   55                      push   rbp
  40064e:   48 89 e5                mov    rbp,rsp
  400651:   48 83 ec 10             sub    rsp,0x10
  400655:   48 8d 45 f0             lea    rax,[rbp-0x10]
  400659:   48 89 c6                mov    rsi,rax
julien@holberton:~/holberton/w/hackthevm2$ ./3 
Address of a: 0x7ffeff0f13b0
Allocated space in the heap: 0x8b3010
Address of function main: 0x40064d
First bytes of the main function:
    55 48 89 e5 48 83 ec 10 48 8d 45 f0 48 89 c6 
julien@holberton:~/holberton/w/hackthevm2$ echo "55 48 89 e5 48 83 ec 10 48 8d 45 f0 48 89 c6" | udcli -64 -x -o 40064d
000000000040064d 55               push rbp                
000000000040064e 4889e5           mov rbp, rsp            
0000000000400651 4883ec10         sub rsp, 0x10           
0000000000400655 488d45f0         lea rax, [rbp-0x10]     
0000000000400659 4889c6           mov rsi, rax            
julien@holberton:~/holberton/w/hackthevm2$
</code></pre></div></div>
<p><em>æç¤º:å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½åæ±‡ç¼–å·¥å…·<a href="http://udis86.sourceforge.net/">Udis86 Disassembler Library</a></em></p>

<p>ç”±æ­¤å¯è§ï¼Œæˆ‘ä»¬æ‰“å°å‡ºæ¥çš„åœ°å€å’Œå†…å®¹éƒ½æ˜¯ä¸€è‡´çš„ã€‚å› æ­¤å¯ä»¥ç¡®è®¤è¿™ä¸ªåœ°å€å°±æ˜¯æˆ‘ä»¬çš„<code class="highlighter-rouge">main</code>å‡½æ•°ã€‚</p>

<p>æ›´æ–°åå†…å­˜å¸ƒå±€ç¤ºæ„å›¾å¦‚ä¸‹:<br />
<img src="http://data.coderhuo.tech/blog/virtual_memory/virtual_memory_stack_heap_executable.png" alt="" /></p>

<h2 id="å…­å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡">å…­ã€å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡</h2>

<p><code class="highlighter-rouge">main</code>å‡½æ•°å¯æ¥æ”¶ä»¥ä¸‹å‚æ•°:</p>

<ul>
  <li>å‘½ä»¤è¡Œå‚æ•°
    <ul>
      <li><code class="highlighter-rouge">main</code>å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°(é€šå¸¸å†™ä½œ<code class="highlighter-rouge">argc</code>æˆ–<code class="highlighter-rouge">ac</code>)ä»£è¡¨å‘½ä»¤è¡Œå‚æ•°çš„ä¸ªæ•°</li>
      <li><code class="highlighter-rouge">main</code>å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°(é€šå¸¸å†™ä½œ<code class="highlighter-rouge">argv</code>æˆ–<code class="highlighter-rouge">av</code>)æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æŒ‡é’ˆæ•°ç»„ï¼Œæ•°ç»„çš„æ¯ä¸ªæˆå‘˜éƒ½æŒ‡å‘ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ï¼ˆCå­—ç¬¦ä¸²ï¼‰</li>
    </ul>
  </li>
  <li>ç¯å¢ƒå˜é‡å‚æ•°
    <ul>
      <li><code class="highlighter-rouge">main</code>å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°(é€šå¸¸å†™ä½œ<code class="highlighter-rouge">env</code>æˆ–<code class="highlighter-rouge">envp</code>)ä¹Ÿæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æŒ‡é’ˆæ•°ç»„ï¼Œæ•°ç»„çš„æ¯ä¸ªæˆå‘˜éƒ½æŒ‡å‘ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼ˆCå­—ç¬¦ä¸²ï¼‰</li>
    </ul>
  </li>
</ul>

<p>æˆ‘ä»¬çœ‹ä¸‹è¿™äº›å…ƒç´ ä½äºè™šæ‹Ÿå†…å­˜çš„å“ªéƒ¨åˆ†ï¼ˆ<code class="highlighter-rouge">main-4.c</code>ï¼‰:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

/**
 * main - print locations of various elements
 *
 * Return: EXIT_FAILURE if something failed. Otherwise EXIT_SUCCESS
 */
int main(int ac, char **av, char **env)
{
        int a;
        void *p;
        int i;

        printf("Address of a: %p\n", (void *)&amp;a);
        p = malloc(98);
        if (p == NULL)
        {
                fprintf(stderr, "Can't malloc\n");
                return (EXIT_FAILURE);
        }
        printf("Allocated space in the heap: %p\n", p);
        printf("Address of function main: %p\n", (void *)main);
        printf("First bytes of the main function:\n\t");
        for (i = 0; i &lt; 15; i++)
        {
                printf("%02x ", ((unsigned char *)main)[i]);
        }
        printf("\n");
        printf("Address of the array of arguments: %p\n", (void *)av);
        printf("Addresses of the arguments:\n\t");
        for (i = 0; i &lt; ac; i++)
        {
                printf("[%s]:%p ", av[i], av[i]);
        }
        printf("\n");
        printf("Address of the array of environment variables: %p\n", (void *)env);
    printf("Address of the first environment variable: %p\n", (void *)(env[0]));
        return (EXIT_SUCCESS);
}
</code></pre></div></div>

<p>ç¼–è¯‘å¹¶è¿è¡Œ:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julien@holberton:~/holberton/w/hackthevm2$ gcc -Wall -Wextra -Werror main-4.c -o 4
julien@holberton:~/holberton/w/hackthevm2$ ./4 Hello Holberton School!
Address of a: 0x7ffe7d6d8da0
Allocated space in the heap: 0xc8c010
Address of function main: 0x40069d
First bytes of the main function:
    55 48 89 e5 48 83 ec 30 89 7d ec 48 89 75 e0 
Address of the array of arguments: 0x7ffe7d6d8e98
Addresses of the arguments:
    [./4]:0x7ffe7d6da373 [Hello]:0x7ffe7d6da377 [Holberton]:0x7ffe7d6da37d [School!]:0x7ffe7d6da387 
Address of the array of environment variables: 0x7ffe7d6d8ec0

/* è¯‘è€…æ³¨ï¼šæ ¹æ®ä¸Šé¢çš„ç¨‹åºï¼Œåº”è¯¥ä¸ä¼šæœ‰ä¸‹é¢çš„è¾“å‡ºçš„ï¼Œä½†ä½œè€…æ¥ä¸‹æ¥çš„è®¨è®ºç”¨åˆ°äº†è¿™éƒ¨åˆ†ï¼Œæ‰€ä»¥ä¿ç•™è¿™éƒ¨åˆ† */
Address of the first environment variables:
    [0x7ffe7d6da38f]:"XDG_VTNR=7"
    [0x7ffe7d6da39a]:"XDG_SESSION_ID=c2"
    [0x7ffe7d6da3ac]:"CLUTTER_IM_MODULE=xim"
julien@holberton:~/holberton/w/hackthevm2$ 
</code></pre></div></div>

<p>åœ¨è¿™ä¹‹å‰æˆ‘ä»¬çŸ¥é“å‘½ä»¤è¡Œå‚æ•°å’Œç¯å¢ƒå˜é‡éƒ½ä½äºæ ˆä¸Šé¢ï¼Œä½†æ˜¯ä¸çŸ¥é“äºŒè€…çš„ç›¸å¯¹ä½ç½®ã€‚ç°åœ¨å¯ä»¥ç¡®å®šäºŒè€…çš„ç›¸å¯¹ä½ç½®ï¼š</p>

<p><code class="highlighter-rouge">stack</code> (<code class="highlighter-rouge">0x7ffe7d6d8da0</code>) &lt; <code class="highlighter-rouge">argv</code> (<code class="highlighter-rouge">0x7ffe7d6d8e98</code>) &lt; <code class="highlighter-rouge">env</code> (<code class="highlighter-rouge">0x7ffe7d6d8ec0</code>) &lt; <code class="highlighter-rouge">arguments</code> (ä» <code class="highlighter-rouge">0x7ffe7d6da373</code> åˆ° <code class="highlighter-rouge">0x7ffe7d6da387</code> + <code class="highlighter-rouge">8</code> (<code class="highlighter-rouge">8</code> = å­—ç¬¦ä¸²<code class="highlighter-rouge">school</code>å¤§å° + <code class="highlighter-rouge">1</code> å­—èŠ‚çš„å­—ç¬¦ä¸²ç»“æŸç¬¦<code class="highlighter-rouge">\0</code>)) &lt; <code class="highlighter-rouge">environment variables</code> (èµ·å§‹åœ°å€æ˜¯<code class="highlighter-rouge">0x7ffe7d6da38f</code>)ã€‚</p>

<p>äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ‰€æœ‰çš„å‘½ä»¤è¡Œå‚æ•°åœ¨å†…å­˜ä¸­éƒ½æ˜¯ç›¸é‚»çš„ï¼Œå¹¶ä¸”å’Œç¯å¢ƒå˜é‡ä¹Ÿæ˜¯ç›¸é‚»çš„ï¼ˆä»<code class="highlighter-rouge">0x7ffe7d6da387</code> + <code class="highlighter-rouge">8</code> = <code class="highlighter-rouge">0x7ffe7d6da38f</code>å¯ä»¥çœ‹å‡ºï¼‰ã€‚</p>

<h3 id="æ•°ç»„å˜é‡argvå’Œenvæ˜¯ç›¸é‚»çš„å—">æ•°ç»„å˜é‡argvå’Œenvæ˜¯ç›¸é‚»çš„å—ï¼Ÿ</h3>

<p>æ•°ç»„å˜é‡<code class="highlighter-rouge">argv</code>æœ‰5ä¸ªå…ƒç´ ï¼ˆ4ä¸ªæ˜¯ä»å‘½ä»¤è¡Œè¾“å…¥çš„ï¼Œå¦ä¸€ä¸ªæ˜¯ç©ºå…ƒç´ <code class="highlighter-rouge">NULL</code> â€“ <code class="highlighter-rouge">argv</code>æ€»æ˜¯ä»¥NULLç»“æŸï¼Œä»¥æ­¤æ ‡è®°æ•°ç»„çš„ç»“å°¾ï¼‰ã€‚<code class="highlighter-rouge">argv</code>çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯æŒ‡å‘<code class="highlighter-rouge">char</code>ç±»å‹çš„æŒ‡é’ˆï¼Œç”±äºæˆ‘ä»¬æ˜¯64ä½ç³»ç»Ÿï¼Œæ‰€ä»¥ä¸€ä¸ªæŒ‡é’ˆæ˜¯8ä¸ªå­—èŠ‚ï¼ˆå¯é€šè¿‡Cè¯­è¨€ä¸­çš„æ“ä½œç¬¦<code class="highlighter-rouge">sizeof()</code>è·å–æŒ‡é’ˆå¤§å°ï¼‰ã€‚å› æ­¤æ•°ç»„<code class="highlighter-rouge">argv</code>å ç”¨ <code class="highlighter-rouge">5 * 8 = 40</code>å­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯åå…­è¿›åˆ¶çš„<code class="highlighter-rouge">0x28</code>ã€‚å°†<code class="highlighter-rouge">0x28</code>åŠ åˆ°<code class="highlighter-rouge">argv</code>çš„èµ·å§‹åœ°å€<code class="highlighter-rouge">0x7ffe7d6d8e98</code>, å¾—åˆ°<code class="highlighter-rouge">0x7ffe7d6d8ec0</code>(<strong>ä¹Ÿå°±æ˜¯<code class="highlighter-rouge">env</code>çš„åœ°å€</strong>)ï¼</p>

<p><strong>å› æ­¤ï¼Œæ•°ç»„å˜é‡argvå’Œenvåœ¨å†…å­˜ä¸­æ˜¯ç›¸é‚»çš„ï¼</strong></p>

<h3 id="ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ç´§æŒ¨ç€æ•°ç»„å˜é‡envå—">ç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°ç´§æŒ¨ç€æ•°ç»„å˜é‡envå—ï¼Ÿ</h3>

<p>ä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç¡®è®¤æ•°ç»„<code class="highlighter-rouge">env</code>çš„å¤§å°ã€‚æ•°ç»„<code class="highlighter-rouge">env</code>ä¹Ÿæ˜¯ä»¥<code class="highlighter-rouge">NULL</code>æŒ‡é’ˆç»“æŸï¼ŒåŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥éå†æ•°ç»„<code class="highlighter-rouge">env</code>ä»¥ç¡®å®šæ•°ç»„å¤§å°ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼ˆ<code class="highlighter-rouge">main-5.c</code>ï¼‰ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

/**                                                                                                      
 * main - print locations of various elements                                                            
 *                                                                                                       
 * Return: EXIT_FAILURE if something failed. Otherwise EXIT_SUCCESS                                      
 */
int main(int ac, char **av, char **env)
{
     int a;
     void *p;
     int i;
     int size;

     printf("Address of a: %p\n", (void *)&amp;a);
     p = malloc(98);
     if (p == NULL)
     {
          fprintf(stderr, "Can't malloc\n");
          return (EXIT_FAILURE);
     }
     printf("Allocated space in the heap: %p\n", p);
     printf("Address of function main: %p\n", (void *)main);
     printf("First bytes of the main function:\n\t");
     for (i = 0; i &lt; 15; i++)
     {
          printf("%02x ", ((unsigned char *)main)[i]);
     }
     printf("\n");
     printf("Address of the array of arguments: %p\n", (void *)av);
     printf("Addresses of the arguments:\n\t");
     for (i = 0; i &lt; ac; i++)
     {
          printf("[%s]:%p ", av[i], av[i]);
     }
     printf("\n");
     printf("Address of the array of environment variables: %p\n", (void *)env);
     printf("Address of the first environment variables:\n");
     for (i = 0; i &lt; 3; i++)
     {
          printf("\t[%p]:\"%s\"\n", env[i], env[i]);
     }
     /* size of the env array */
     i = 0;
     while (env[i] != NULL)
     {
          i++;
     }
     i++; /* the NULL pointer */
     size = i * sizeof(char *);
     printf("Size of the array env: %d elements -&gt; %d bytes (0x%x)\n", i, size, size);
     return (EXIT_SUCCESS);
}
</code></pre></div></div>
<p>ç¼–è¯‘è¿è¡Œï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julien@holberton:~/holberton/w/hackthevm2$ ./5 Hello Betty Holberton!
Address of a: 0x7ffc77598acc
Allocated space in the heap: 0x2216010
Address of function main: 0x40069d
First bytes of the main function:
    55 48 89 e5 48 83 ec 40 89 7d dc 48 89 75 d0 
Address of the array of arguments: 0x7ffc77598bc8
Addresses of the arguments:
    [./5]:0x7ffc7759a374 [Hello]:0x7ffc7759a378 [Betty]:0x7ffc7759a37e [Holberton!]:0x7ffc7759a384 
Address of the array of environment variables: 0x7ffc77598bf0
Address of the first environment variables:
    [0x7ffc7759a38f]:"XDG_VTNR=7"
    [0x7ffc7759a39a]:"XDG_SESSION_ID=c2"
    [0x7ffc7759a3ac]:"CLUTTER_IM_MODULE=xim"
Size of the array env: 62 elements -&gt; 496 bytes (0x1f0)


julien@holberton:~/holberton/w/hackthevm2$ bc
bc 1.06.95
Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006 Free Software Foundation, Inc.
This is free software with ABSOLUTELY NO WARRANTY.
For details type `warranty'. 
obase=16
ibase=16
1F0+7FFC77598BF0
7FFC77598DE0
quit
julien@holberton:~/holberton/w/hackthevm2$ 
</code></pre></div></div>
<p><code class="highlighter-rouge">0x1F0 + 0x7FFC77598BF0 = 0x7FFC77598DE0</code>, è¯¥å€¼ä»ç„¶å°äºç¬¬ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°çš„å­˜å‚¨åœ°å€<code class="highlighter-rouge">0x7ffc7759a374</code>ã€‚<strong>æ‰€ä»¥ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼</strong></p>

<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”»å‡ºå¦‚ä¸‹æ‰€ç¤ºçš„å†…å­˜å¸ƒå±€å›¾(æ³¨æ„å“ªäº›æ˜¯ç›¸é‚»çš„ï¼Œå“ªäº›æ˜¯ä¸ç›¸é‚»çš„)ï¼š</p>

<p><em>è¯‘è€…æ³¨ï¼šä¸‹å›¾ä¸­çš„<code class="highlighter-rouge">argv array</code>æŒ‡çš„æ˜¯å˜é‡<code class="highlighter-rouge">argv</code>çš„åœ°å€ï¼Œâ€™env arrayâ€™æŒ‡çš„æ˜¯å˜é‡<code class="highlighter-rouge">env</code>çš„åœ°å€ã€‚</em></p>

<p><img src="http://data.coderhuo.tech/blog/virtual_memory/virtual_memory_args_env.png" alt="" /></p>

<h2 id="ä¸ƒæ ˆçœŸçš„æ˜¯å‘ä¸‹ç”Ÿé•¿å—">ä¸ƒã€æ ˆçœŸçš„æ˜¯å‘ä¸‹ç”Ÿé•¿å—ï¼Ÿ</h2>
<p>å¯ä»¥é€šè¿‡å‡½æ•°è°ƒç”¨æ¥ç¡®è®¤è¿™ä¸ªé—®é¢˜ã€‚<strong>å¦‚æœæ ˆçœŸçš„å‘ä¸‹ç”Ÿé•¿ï¼Œè°ƒç”¨å‡½æ•°ä¸­çš„å˜é‡åœ°å€åº”è¯¥å¤§äºè¢«è°ƒç”¨å‡½æ•°ä¸­çš„å˜é‡åœ°å€</strong>ï¼ˆ<code class="highlighter-rouge">main-6.c</code>ï¼‰ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

/**                                                                                                      
 * f - print locations of various elements                                                               
 *                                                                                                       
 * Returns: nothing                                                                                      
 */
void f(void)
{
     int a;
     int b;
     int c;

     a = 98;
     b = 1024;
     c = a * b;
     printf("[f] a = %d, b = %d, c = a * b = %d\n", a, b, c);
     printf("[f] Adresses of a: %p, b = %p, c = %p\n", (void *)&amp;a, (void *)&amp;b, (void *)&amp;c);
}

/**                                                                                                      
 * main - print locations of various elements                                                            
 *                                                                                                       
 * Return: EXIT_FAILURE if something failed. Otherwise EXIT_SUCCESS                                      
 */
int main(int ac, char **av, char **env)
{
     int a;
     void *p;
     int i;
     int size;

     printf("Address of a: %p\n", (void *)&amp;a);
     p = malloc(98);
     if (p == NULL)
     {
          fprintf(stderr, "Can't malloc\n");
          return (EXIT_FAILURE);
     }
     printf("Allocated space in the heap: %p\n", p);
     printf("Address of function main: %p\n", (void *)main);
     printf("First bytes of the main function:\n\t");
     for (i = 0; i &lt; 15; i++)
     {
          printf("%02x ", ((unsigned char *)main)[i]);
     }
     printf("\n");
     printf("Address of the array of arguments: %p\n", (void *)av);
     printf("Addresses of the arguments:\n\t");
     for (i = 0; i &lt; ac; i++)
     {
          printf("[%s]:%p ", av[i], av[i]);
     }
     printf("\n");
     printf("Address of the array of environment variables: %p\n", (void *)env);
     printf("Address of the first environment variables:\n");
     for (i = 0; i &lt; 3; i++)
     {
          printf("\t[%p]:\"%s\"\n", env[i], env[i]);
     }
     /* size of the env array */
     i = 0;
     while (env[i] != NULL)
     {
          i++;
     }
     i++; /* the NULL pointer */
     size = i * sizeof(char *);
     printf("Size of the array env: %d elements -&gt; %d bytes (0x%x)\n", i, size, size);
     f();
     return (EXIT_SUCCESS);
}
</code></pre></div></div>
<p>ç¼–è¯‘è¿è¡Œ:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julien@holberton:~/holberton/w/hackthevm2$ gcc -Wall -Wextra -Werror main-6.c -o 6
julien@holberton:~/holberton/w/hackthevm2$ ./6
Address of a: 0x7ffdae53ea4c
Allocated space in the heap: 0xf32010
Address of function main: 0x4006f9
First bytes of the main function:
    55 48 89 e5 48 83 ec 40 89 7d dc 48 89 75 d0 
Address of the array of arguments: 0x7ffdae53eb48
Addresses of the arguments:
    [./6]:0x7ffdae54038b 
Address of the array of environment variables: 0x7ffdae53eb58
Address of the first environment variables:
    [0x7ffdae54038f]:"XDG_VTNR=7"
    [0x7ffdae54039a]:"XDG_SESSION_ID=c2"
    [0x7ffdae5403ac]:"CLUTTER_IM_MODULE=xim"
Size of the array env: 62 elements -&gt; 496 bytes (0x1f0)
[f] a = 98, b = 1024, c = a * b = 100352
[f] Adresses of a: 0x7ffdae53ea04, b = 0x7ffdae53ea08, c = 0x7ffdae53ea0c
julien@holberton:~/holberton/w/hackthevm2$ 
</code></pre></div></div>
<p><code class="highlighter-rouge">main</code>å‡½æ•°ä¸­å˜é‡<code class="highlighter-rouge">a</code>çš„åœ°å€<code class="highlighter-rouge">0x7ffdae53ea4c</code>å¤§äºè¢«è°ƒç”¨å‡½æ•°<code class="highlighter-rouge">f</code>ä¸­å˜é‡<code class="highlighter-rouge">a</code>çš„åœ°å€<code class="highlighter-rouge">0x7ffdae53ea04 </code>ã€‚æ‰€ä»¥ï¼Œ<strong>æ ˆç¡®å®æ˜¯å‘ä¸‹ç”Ÿé•¿çš„ï¼</strong></p>

<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”»å‡ºå¦‚ä¸‹æ‰€ç¤ºçš„å†…å­˜å¸ƒå±€å›¾(æ³¨æ„æ ˆçš„ç”Ÿé•¿æ–¹å‘)ï¼š</p>

<p><img src="http://data.coderhuo.tech/blog/virtual_memory/virtual_memory_stack.png" alt="" /></p>

<h2 id="å…«proc">å…«ã€/proc</h2>

<p>æˆ‘ä»¬é€šè¿‡<code class="highlighter-rouge">/proc/[pid]/maps</code>ï¼ˆå¯å‚é˜…<code class="highlighter-rouge">man proc</code>æˆ–<a href="http://blog.coderhuo.tech/2017/10/12/Virtual_Memory_C_strings_proc/">ã€Šè™šæ‹Ÿå†…å­˜æ¢ç©¶ â€“ ç¬¬ä¸€ç¯‡:C strings &amp; /procã€‹</a>ä¸­çš„ç›¸å…³ä»‹ç»ï¼‰å†æ¬¡ç¡®è®¤ä¹‹å‰å¾—åˆ°çš„ç»“è®ºæ˜¯å¦æ­£ç¡®ã€‚</p>

<p>æˆ‘ä»¬åœ¨(<code class="highlighter-rouge">main-6.c</code>)çš„åŸºç¡€ä¸Šæ·»åŠ ä¸ª<code class="highlighter-rouge">getchar()</code>å‡½æ•°ä»¥ä¾¿æš‚åœç¨‹åºçš„æ‰§è¡Œï¼Œæœ‰æ—¶é—´æŸ¥çœ‹<code class="highlighter-rouge">/proc</code>(<code class="highlighter-rouge">main-7.c</code>)ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

/**                                                                                                      
 * f - print locations of various elements                                                               
 *                                                                                                       
 * Returns: nothing                                                                                      
 */
void f(void)
{
     int a;
     int b;
     int c;

     a = 98;
     b = 1024;
     c = a * b;
     printf("[f] a = %d, b = %d, c = a * b = %d\n", a, b, c);
     printf("[f] Adresses of a: %p, b = %p, c = %p\n", (void *)&amp;a, (void *)&amp;b, (void *)&amp;c);
}

/**                                                                                                      
 * main - print locations of various elements                                                            
 *                                                                                                       
 * Return: EXIT_FAILURE if something failed. Otherwise EXIT_SUCCESS                                      
 */
int main(int ac, char **av, char **env)
{
     int a;
     void *p;
     int i;
     int size;

     printf("Address of a: %p\n", (void *)&amp;a);
     p = malloc(98);
     if (p == NULL)
     {
          fprintf(stderr, "Can't malloc\n");
          return (EXIT_FAILURE);
     }
     printf("Allocated space in the heap: %p\n", p);
     printf("Address of function main: %p\n", (void *)main);
     printf("First bytes of the main function:\n\t");
     for (i = 0; i &lt; 15; i++)
     {
          printf("%02x ", ((unsigned char *)main)[i]);
     }
     printf("\n");
     printf("Address of the array of arguments: %p\n", (void *)av);
     printf("Addresses of the arguments:\n\t");
     for (i = 0; i &lt; ac; i++)
     {
          printf("[%s]:%p ", av[i], av[i]);
     }
     printf("\n");
     printf("Address of the array of environment variables: %p\n", (void *)env);
     printf("Address of the first environment variables:\n");
     for (i = 0; i &lt; 3; i++)
     {
          printf("\t[%p]:\"%s\"\n", env[i], env[i]);
     }
     /* size of the env array */
     i = 0;
     while (env[i] != NULL)
     {
          i++;
     }
     i++; /* the NULL pointer */
     size = i * sizeof(char *);
     printf("Size of the array env: %d elements -&gt; %d bytes (0x%x)\n", i, size, size);
     f();
     getchar();
     return (EXIT_SUCCESS);
}
</code></pre></div></div>
<p>ç¼–è¯‘æ‰§è¡Œ:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julien@holberton:~/holberton/w/hackthevm2$ gcc -Wall -Wextra -Werror main-7.c -o 7
julien@holberton:~/holberton/w/hackthevm2$ ./7 Rona is a Legend SRE
Address of a: 0x7fff16c8146c
Allocated space in the heap: 0x2050010
Address of function main: 0x400739
First bytes of the main function:
    55 48 89 e5 48 83 ec 40 89 7d dc 48 89 75 d0 
Address of the array of arguments: 0x7fff16c81568
Addresses of the arguments:
    [./7]:0x7fff16c82376 [Rona]:0x7fff16c8237a [is]:0x7fff16c8237f [a]:0x7fff16c82382 [Legend]:0x7fff16c82384 [SRE]:0x7fff16c8238b 
Address of the array of environment variables: 0x7fff16c815a0
Address of the first environment variables:
    [0x7fff16c8238f]:"XDG_VTNR=7"
    [0x7fff16c8239a]:"XDG_SESSION_ID=c2"
    [0x7fff16c823ac]:"CLUTTER_IM_MODULE=xim"
Size of the array env: 62 elements -&gt; 496 bytes (0x1f0)
[f] a = 98, b = 1024, c = a * b = 100352
[f] Adresses of a: 0x7fff16c81424, b = 0x7fff16c81428, c = 0x7fff16c8142c
</code></pre></div></div>

<p>æŸ¥çœ‹<code class="highlighter-rouge">/proc/[pid]/maps</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julien@holberton:~$ ps aux | grep "./7" | grep -v grep
julien     5788  0.0  0.0   4336   628 pts/8    S+   18:04   0:00 ./7 Rona is a Legend SRE
julien@holberton:~$ cat /proc/5788/maps
00400000-00401000 r-xp 00000000 08:01 171828                             /home/julien/holberton/w/hackthevm2/7
00600000-00601000 r--p 00000000 08:01 171828                             /home/julien/holberton/w/hackthevm2/7
00601000-00602000 rw-p 00001000 08:01 171828                             /home/julien/holberton/w/hackthevm2/7
02050000-02071000 rw-p 00000000 00:00 0                                  [heap]
7f68caa1c000-7f68cabd6000 r-xp 00000000 08:01 136253                     /lib/x86_64-linux-gnu/libc-2.19.so
7f68cabd6000-7f68cadd6000 ---p 001ba000 08:01 136253                     /lib/x86_64-linux-gnu/libc-2.19.so
7f68cadd6000-7f68cadda000 r--p 001ba000 08:01 136253                     /lib/x86_64-linux-gnu/libc-2.19.so
7f68cadda000-7f68caddc000 rw-p 001be000 08:01 136253                     /lib/x86_64-linux-gnu/libc-2.19.so
7f68caddc000-7f68cade1000 rw-p 00000000 00:00 0 
7f68cade1000-7f68cae04000 r-xp 00000000 08:01 136229                     /lib/x86_64-linux-gnu/ld-2.19.so
7f68cafe8000-7f68cafeb000 rw-p 00000000 00:00 0 
7f68cafff000-7f68cb003000 rw-p 00000000 00:00 0 
7f68cb003000-7f68cb004000 r--p 00022000 08:01 136229                     /lib/x86_64-linux-gnu/ld-2.19.so
7f68cb004000-7f68cb005000 rw-p 00023000 08:01 136229                     /lib/x86_64-linux-gnu/ld-2.19.so
7f68cb005000-7f68cb006000 rw-p 00000000 00:00 0 
7fff16c62000-7fff16c83000 rw-p 00000000 00:00 0                          [stack]
7fff16d07000-7fff16d09000 r--p 00000000 00:00 0                          [vvar]
7fff16d09000-7fff16d0b000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]
julien@holberton:~$ 
</code></pre></div></div>
<p>é€šè¿‡<code class="highlighter-rouge">maps</code>æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®è®¤ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
  <li>æ ˆåœ°å€ä»<code class="highlighter-rouge">0x7fff16c62000</code>å¼€å§‹ï¼Œç»“æŸäº<code class="highlighter-rouge">0x7fff16c83000</code>ã€‚æˆ‘ä»¬çš„å±€éƒ¨å˜é‡éƒ½ä½äºè¿™ä¸€åŒºåŸŸ(<code class="highlighter-rouge">0x7fff16c8146c</code>, <code class="highlighter-rouge">0x7fff16c81424</code>, <code class="highlighter-rouge">0x7fff16c81428</code>, <code class="highlighter-rouge">0x7fff16c8142c</code>)ã€‚</li>
  <li>å †åœ°å€ä»<code class="highlighter-rouge">02050000</code>å¼€å§‹ï¼Œç»“æŸäº<code class="highlighter-rouge">02071000</code>ã€‚æˆ‘ä»¬åŠ¨æ€åˆ†é…çš„å†…å­˜ä¹Ÿä½äºè¿™ä¸€åŒºåŸŸï¼ˆ<code class="highlighter-rouge">0x2050010</code>ï¼‰ã€‚</li>
  <li>
    <p>ä»£ç æ®µï¼ˆ<code class="highlighter-rouge">main</code>å‡½æ•°ï¼‰ä½äºåœ°å€<code class="highlighter-rouge">0x400739</code>ï¼Œå› æ­¤ä½äºä¸‹é¢çš„åŒºæ®µï¼š</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  00400000-00401000 r-xp 00000000 08:01 171828 /home/julien/holberton/w/hackthevm2/7
</code></pre></div>    </div>
    <p>å®ƒæ¥è‡ªå¯æ‰§è¡Œæ–‡ä»¶<code class="highlighter-rouge">/home/julien/holberton/w/hackthevm2/7</code>ï¼Œå¹¶ä¸”å…·æœ‰å¯æ‰§è¡Œæƒé™ã€‚</p>
  </li>
  <li>å‘½ä»¤è¡Œå‚æ•°ï¼ˆå˜é‡argvï¼‰å’Œç¯å¢ƒå˜é‡å‚æ•°(å˜é‡env)(ä»åœ°å€<code class="highlighter-rouge">0x7fff16c81568</code> åˆ° <code class="highlighter-rouge">0x7fff16c8238f</code> + <code class="highlighter-rouge">0x1f0</code>)è½åœ¨æ ˆçš„èŒƒå›´å†…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å®ƒä»¬åœ¨æ ˆå†…éƒ¨è€Œä¸æ˜¯åœ¨æ ˆå¤–é¢ã€‚</strong></li>
</ul>

<p>è¿™ä¹Ÿå¸¦æ¥äº†æ›´å¤šçš„é—®é¢˜ï¼š</p>
<ul>
  <li>ä¸ºä»€ä¹ˆå¯æ‰§è¡Œæ–‡ä»¶åœ¨å†…å­˜ä¸­è¢«åˆ†æˆä¸‰éƒ¨åˆ†ï¼Œå¹¶ä¸”æ¯éƒ¨åˆ†å…·æœ‰ä¸åŒçš„æƒé™ï¼Ÿä¸‹é¢ä¸¤ä¸ªåŒºåŸŸä¸­æ˜¯ä»€ä¹ˆï¼Ÿ
    <ul>
      <li><code class="highlighter-rouge">00600000-00601000 r--p 00000000 08:01 171828 /home/julien/holberton/w/hackthevm2/7</code></li>
      <li><code class="highlighter-rouge">00601000-00602000 rw-p 00001000 08:01 171828 /home/julien/holberton/w/hackthevm2/7</code></li>
    </ul>
  </li>
  <li>å…¶ä»–çš„åŒºæ®µåˆæ˜¯å¹²å˜›çš„ï¼Ÿ</li>
  <li>æˆ‘ä»¬åŠ¨æ€åˆ†é…çš„å†…å­˜ä¸ºä½•ä¸æ˜¯ä»å †çš„èµ·å§‹ä½ç½®<code class="highlighter-rouge">0x2050000</code>å¼€å§‹ï¼Œè€Œæ˜¯åç§»16ä¸ªå­—èŠ‚ä»<code class="highlighter-rouge">0x2050010</code>å¼€å§‹ï¼Ÿ</li>
</ul>

<p>å½“ç„¶è¿˜æœ‰å¦ä¸€ä¸ªäº‹å®æ²¡æœ‰ç¡®è®¤ï¼šå †çœŸçš„æ˜¯å‘ä¸Šç”Ÿé•¿çš„å—ï¼Ÿ</p>

<p>æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­è§£ç­”è¿™äº›é—®é¢˜ã€‚åœ¨ç»“æŸæœ¬ç« å‰ï¼Œè®©æˆ‘ä»¬çœ‹ä¸‹ç›®å‰å¾—åˆ°çš„è™šæ‹Ÿå†…å­˜ç¤ºæ„å›¾ï¼š</p>

<p><img src="http://data.coderhuo.tech/blog/virtual_memory/virtual_memory_args_stack.png" alt="" /></p>

<h2 id="ä¹ä¸‹èŠ‚é¢„å‘Š">ä¹ã€ä¸‹èŠ‚é¢„å‘Š</h2>
<p>é€šè¿‡ç®€å•çš„æ‰“å°ä¿¡æ¯ï¼Œæˆ‘ä»¬å­¦åˆ°äº†æœ‰å…³è™šæ‹Ÿå†…å­˜çš„å¾ˆå¤šçŸ¥è¯†ã€‚ä½†æ˜¯åœ¨å®Œæˆè™šæ‹Ÿå†…å­˜å¸ƒå±€å›¾ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æœ‰ä¸€äº›é—®é¢˜éœ€è¦è§£å†³ã€‚ä¸‹ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬å°†è§£å†³å‰©ä½™é—®é¢˜ã€‚</p>

<h2 id="åç»§ç»­é˜…è¯»">åã€ç»§ç»­é˜…è¯»</h2>

<ul>
  <li>ç¬¬ä¸€ç¯‡:<a href="http://blog.coderhuo.tech/2017/10/12/Virtual_Memory_C_strings_proc/">è™šæ‹Ÿå†…å­˜æ¢ç©¶ â€“ ç¬¬ä¸€ç¯‡:C strings &amp; /proc</a></li>
  <li>ç¬¬äºŒç¯‡:<a href="http://blog.coderhuo.tech/2017/10/15/Virtual_Memory_python_bytes/">è™šæ‹Ÿå†…å­˜æ¢ç©¶ â€“ ç¬¬äºŒç¯‡:Python å­—èŠ‚</a></li>
  <li>ç¬¬ä¸‰ç¯‡:<a href="http://blog.coderhuo.tech/2017/10/16/Virtual_Memory_drawing_VM_diagram/">è™šæ‹Ÿå†…å­˜æ¢ç©¶ â€“ ç¬¬ä¸‰ç¯‡:ä¸€æ­¥ä¸€æ­¥ç”»è™šæ‹Ÿå†…å­˜å›¾</a></li>
  <li>ç¬¬å››ç¯‡:<a href="http://blog.coderhuo.tech/2017/10/18/Virtual_Memory_malloc_and_heap/">è™šæ‹Ÿå†…å­˜æ¢ç©¶ â€“ ç¬¬å››ç¯‡:malloc, heap &amp; the program break</a></li>
  <li>ç¬¬äº”ç¯‡:<a href="http://blog.coderhuo.tech/2019/08/31/Virtual_Memory_malloc_and_heap_stack_and_register/">è™šæ‹Ÿå†…å­˜æ¢ç©¶ â€“ ç¬¬äº”ç¯‡:The Stack, registers and assembly code</a></li>
</ul>

<h2 id="åä¸€åŸæ–‡é“¾æ¥">åä¸€ã€åŸæ–‡é“¾æ¥</h2>
<p><a href="https://blog.holbertonschool.com/hack-the-virtual-memory-drawing-the-vm-diagram/">Hack The Virtual Memory: Drawing the VM diagram</a></p>
:ET